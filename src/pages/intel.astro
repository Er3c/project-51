---
import Layout from "../layouts/Layout.astro";
import { getCollection } from "astro:content";

export const prerender = true;

const posts = await getCollection("intel");
const sortedPosts = posts.sort(
    (a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf(),
);
---

<Layout 
	title="Intelligence Briefings | Project 51 - Geopolitical Analysis & Updates"
	description="Read official intelligence briefings and geopolitical analysis from the Project 51 Transition Committee. Explore strategic assessments, policy updates, and data-driven insights on Greenland statehood scenarios."
>
    <div class="bg-slate-900 min-h-screen">
        <!-- Hero Section -->
        <div
            class="relative bg-gradient-to-b from-slate-900 via-slate-800 to-slate-900 py-16 md:py-20"
        >
            <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <div
                    class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-red-500/10 border border-red-500/30 mb-6"
                >
                    <span class="text-2xl">ðŸ”’</span>
                    <span
                        class="text-sm font-mono text-red-400 tracking-wider uppercase"
                        >Classified Intel</span
                    >
                </div>
                <h1
                    class="text-4xl md:text-5xl font-black text-white mb-4 leading-tight"
                >
                    Intelligence <span
                        class="text-transparent bg-clip-text bg-gradient-to-r from-liberation-blue to-cyan-400"
                        >Briefings</span
                    >
                </h1>
                <p class="text-lg text-slate-400 max-w-2xl mx-auto mb-2">
                    Official communiquÃ©s and updates from the Transition
                    Committee
                </p>
                <p class="text-xs text-slate-600 font-mono">
                    SECURITY CLEARANCE: PUBLIC // DISTRIBUTION: UNRESTRICTED
                </p>
            </div>
        </div>

        <!-- Intel Posts -->
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
            <div class="space-y-6">
                {
                    sortedPosts.map((post, index) => (
                        <a
                            href={`/intel/${post.slug}`}
                            class="block group"
                        >
                            <article class="bg-slate-800/50 backdrop-blur border border-slate-700 rounded-xl overflow-hidden hover:border-liberation-blue transition-all hover:shadow-lg hover:shadow-liberation-blue/10">
                                <div class="p-6 md:p-8">
                                    <!-- Header -->
                                    <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4">
                                        <div class="flex items-center gap-3">
                                            <div class="flex items-center justify-center w-12 h-12 rounded-lg bg-liberation-blue/10 border border-liberation-blue/30 text-liberation-blue font-bold text-lg">
                                                {String(index + 1).padStart(2, '0')}
                                            </div>
                                            <div>
                                                <div class="text-xs font-mono text-slate-500 uppercase tracking-wider">
                                                    CommuniquÃ©
                                                </div>
                                                <div class="text-sm font-mono text-liberation-blue">
                                                    {post.data.publishDate.toISOString().split("T")[0]}
                                                </div>
                                            </div>
                                        </div>
                                        <div class="flex items-center gap-2 text-xs font-mono text-slate-500">
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                            </svg>
                                            <span class="uppercase">{post.data.author}</span>
                                        </div>
                                    </div>

                                    <!-- Title -->
                                    <h2 class="text-2xl md:text-3xl font-bold text-white mb-3 group-hover:text-liberation-blue transition-colors">
                                        {post.data.title}
                                    </h2>

                                    <!-- Description -->
                                    <p class="text-slate-300 text-base leading-relaxed mb-4">
                                        {post.data.description}
                                    </p>

                                    <!-- Tags & Read More -->
                                    <div class="flex flex-wrap items-center justify-between gap-4">
                                        <div class="flex flex-wrap gap-2">
                                            {post.data.tags?.map((tag) => (
                                                <span class="px-3 py-1 bg-slate-700/50 border border-slate-600 text-slate-300 text-xs rounded-full font-medium">
                                                    #{tag}
                                                </span>
                                            ))}
                                        </div>
                                        <div class="flex items-center gap-2 text-liberation-blue text-sm font-semibold group-hover:gap-3 transition-all">
                                            <span>Read Brief</span>
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                            </svg>
                                        </div>
                                    </div>
                                </div>
                            </article>
                        </a>
                    ))
                }
            </div>

            {
                sortedPosts.length === 0 && (
                    <div class="text-center py-20 bg-slate-800/30 rounded-xl border-2 border-dashed border-slate-700">
                        <div class="text-6xl mb-4">ðŸ”’</div>
                        <p class="text-slate-400 font-mono text-lg mb-2">
                            NO INTEL AVAILABLE
                        </p>
                        <p class="text-slate-600 text-sm font-mono">
                            Secure channel standing by for classified briefings
                        </p>
                    </div>
                )
            }
        </div>
    </div>
</Layout>
